//- Footer (본문과 같은 너비)
footer#footer(class='mt-12 mb-9')
  //- 기본 구분선
  hr(class='mb-8 border-t border-h-300 dark:border-h-600')
  //- 게시글 버튼 영역 (article에서 이동됨)
  #footer-postbtn-area
  
  if hasCategory
    include Footer/RelatedArticle
  include Footer/Author
  
  //- 댓글 영역
  s_rp
    +group('comment')

//- container_postbtn을 footer로 이동시키는 스크립트
script(once='move-postbtn-to-footer').
  document.addEventListener('DOMContentLoaded', function() {
    const postbtn = document.querySelector('#article .container_postbtn');
    const footerArea = document.querySelector('#footer-postbtn-area');
    if (postbtn && footerArea) {
      footerArea.appendChild(postbtn);
    }
    
    // SupportButton 숨김
    const supportBtn = document.querySelector('[data-tistory-react-app="SupportButton"]');
    if (supportBtn) {
      supportBtn.style.display = 'none';
    }
    
    // 신고 버튼(.btn_etc2) 완전 제거
    const reportBtn = document.querySelector('.btn_etc2');
    if (reportBtn) {
      reportBtn.remove();
    }
    
    // 티스토리 기본 구독 버튼을 Author 영역으로 이동
    const defaultSubscription = document.querySelector('.container_postbtn > .btn_subscription');
    const authorArea = document.querySelector('#author');
    if (defaultSubscription && authorArea) {
      authorArea.appendChild(defaultSubscription);
    }
  });

style(once='footer-postbtn-style')
  :postcss
    #footer-postbtn-area {
      @apply mb-8;
      
      .container_postbtn {
        @apply flex gap-x-3 p-0 text-h-600 dark:text-h-200;

        /* 공통 버튼 스타일: 아이콘 + 텍스트 (Author 영역으로 이동된 구독 버튼 제외) */
        .postbtn_like > .wrap_btn:not([id^=reaction-]) > button,
        .tt-btn-support {
          @apply h-9 px-3 inline-flex items-center gap-x-2 shadow-none outline-0 rounded-md cursor-pointer duration-200 leading-none p-0 m-0 bg-h-200 border-0 hover:bg-h-300;
          @apply dark:bg-h-700 dark:hover:bg-h-600;
          @apply text-sm text-h-600 dark:text-h-200;
        }

        .postbtn_like {
          @apply border-0 p-0 flex gap-x-3;

          .wrap_btn {
            @apply inline-block border-0;

            button,
            button[data-entry-id],
            .uoc-count {
              &::before {
                @apply font-bold text-sm text-h-500 dark:text-h-300;
              }
            }

            .ico_like,
            .ico_share,
            .ico_statistics,
            .ico_etc {
              @apply text-hidden bg-none;
            }

            /* 공감 버튼 (아이콘 + count + 텍스트) */
            &[id^=reaction-] button {
              @apply px-4 h-9 rounded-md bg-h-200 hover:bg-h-300 inline-flex items-center gap-x-2;
              @apply dark:bg-h-700 dark:hover:bg-h-600;

              /* 따봉 아이콘 (빈 아이콘 - Regular) */
              &::before {
                content: '\f164';
                font-family: 'Font Awesome 6 Free';
                font-weight: 400;
                @apply text-h-500 dark:text-h-300 transition-all text-base;
              }

              /* div.uoc-icon 컨테이너는 표시 */
              div.uoc-icon {
                @apply inline-flex items-center;
                display: inline-flex !important;
              }
              
              /* 기본 아이콘 숨김 */
              .ico_like {
                @apply hidden;
              }

              .uoc-count {
                @apply font-bold leading-none text-h-600 dark:text-h-200 text-sm;
                display: inline-block !important;
                font-size: 14px !important;
                overflow: visible !important;
                text-indent: 0 !important;
                width: auto !important;
                height: auto !important;
                background: none !important;

                /* "좋아요" 텍스트 */
                &::after {
                  content: ' 좋아요';
                  @apply text-sm font-normal text-h-500 dark:text-h-300;
                }
              }
            }
            
            /* 좋아요 눌렀을 때 (활성화 상태) - .uoc-icon에 .like_on 클래스가 붙음 */
            &[id^=reaction-]:has(.like_on) button {
              @apply bg-h-blue/10;
              
              /* 채워진 따봉 아이콘 (Solid) + 파란색 */
              &::before {
                font-weight: 900 !important;
                @apply text-h-blue;
              }
            }

            /* 공유 버튼 */
            &.wrap_btn_share .btn_share {
              @apply inline-flex items-center gap-x-2 px-3;
              
              &::before {
                @apply fa-share-nodes text-h-500 dark:text-h-300;
              }
              
              &::after {
                content: '공유';
                @apply text-sm;
              }
            }

            /* 통계 버튼 - 본인만 볼 수 있음 (티스토리가 자동 처리) */
            button[data-entry-id] {
              @apply inline-flex items-center gap-x-2 px-3;
              
              &::before {
                @apply fa-chart-pie text-h-500 dark:text-h-300;
              }
              
              &::after {
                content: '통계';
                @apply text-sm;
              }
            }

            /* 관리(수정) 버튼 - 본인만 볼 수 있음 */
            &.wrap_btn_etc {
              .btn_etc1 {
                @apply inline-flex items-center gap-x-2 px-3;
                
                &::before {
                  @apply fa-wrench text-h-500 dark:text-h-300;
                }
                
                &::after {
                  content: '수정';
                  @apply text-sm;
                }
              }

              /* 신고 버튼 완전 제거 */
              .btn_etc2 {
                @apply hidden;
              }
            }
          }
        }

        /* 서포트 버튼 숨김 */
        [data-tistory-react-app="SupportButton"] {
          @apply hidden;
        }
        
        /* 티스토리 기본 구독 버튼 숨김 (커스텀 버튼만 사용) */
        > .btn_subscription:not([data-teleport-target]) {
          @apply hidden;
        }
        
        /* 구독 버튼 텍스트 스타일 */
        .btn_subscription[data-teleport-target] {
          .txt_state {
            @apply text-sm text-h-600 dark:text-h-200;
          }
          
          .txt_tool_id,
          .ico_check_type1 {
            @apply hidden;
          }
        }
      }
    }

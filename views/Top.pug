//- GNB (Global Navigation Bar)
nav#global-navigation(
  class='w-full bg-h-100 dark:bg-h-800 border-b border-h-300 dark:border-h-700 mb-8'
  aria-label='주 메뉴'
)
  .container(class='max-w-7xl mx-auto px-4 py-3 flex items-center')
    //- 모바일 사이드바 토글 버튼
    button.sidebar-toggle(
      @click='sidebar = !sidebar'
      class='xl:hidden mr-4 flex-shrink-0 text-h-600 dark:text-h-400 hover:text-h-900 dark:hover:text-h-100 transition-colors'
      aria-label='메뉴 열기/닫기')
      i(class='fa-solid fa-bars text-xl')
    
    //- 카테고리 메가 메뉴 (1depth 가로 배치, 2depth 호버 드롭다운)
    nav#header-categories.category-mega-menu(class='flex-1 min-w-0 overflow-x-auto')
    
    //- 테마 토글 버튼 (우측 고정)
    button.theme-toggle(
      x-data='bottom'
      @click='toggleTheme'
      class='ml-4 flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-full text-h-600 dark:text-h-400 hover:bg-h-200 dark:hover:bg-h-700 hover:text-h-900 dark:hover:text-h-100 transition-colors'
      aria-label='테마 변경')
      i(:class="($store.app && $store.app.dark) ? 'fa-solid fa-sun text-lg' : 'fa-solid fa-moon text-lg'")

script.
  // 카테고리 메가 메뉴 생성 (사이드바 로드 대기)
  ;document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      var sidebarCategory = document.querySelector('#sidebar .tt_category');
      var headerCategories = document.querySelector('#header-categories');
      
      if (sidebarCategory && headerCategories) {
        var categoryItems = sidebarCategory.querySelectorAll('.category_list > li');
        
        if (categoryItems.length > 0) {
          var megaMenu = document.createElement('ul');
          megaMenu.className = 'mega-menu-list';
          
          categoryItems.forEach(function(item) {
            var clonedItem = item.cloneNode(true);
            var link = clonedItem.querySelector('.link_item');
            
            if (link) {
              var menuItem = document.createElement('li');
              menuItem.className = 'mega-menu-item';
              
              var mainLink = document.createElement('a');
              mainLink.href = link.href;
              mainLink.textContent = link.textContent.split('(')[0].trim();
              mainLink.className = 'mega-menu-link';
              
              menuItem.appendChild(mainLink);
              
              var subCategoryList = clonedItem.querySelector('.sub_category_list');
              if (subCategoryList) {
                var dropdown = document.createElement('div');
                dropdown.className = 'mega-menu-dropdown';
                dropdown.appendChild(subCategoryList.cloneNode(true));
                menuItem.appendChild(dropdown);
              }
              
              megaMenu.appendChild(menuItem);
            }
          });
          
          headerCategories.appendChild(megaMenu);
        }
      }
    }, 100);
  });

style
  :postcss
    #global-navigation {
      .category-mega-menu {
        @apply overflow-x-auto xl:overflow-visible;
        
        /* 스크롤바 숨기기 (모바일) */
        &::-webkit-scrollbar {
          display: none;
        }
        -ms-overflow-style: none;
        scrollbar-width: none;
        
        .mega-menu-list {
          @apply flex gap-4 items-center m-0 p-0;
          @apply flex-nowrap xl:flex-wrap xl:justify-center;
          @apply min-w-max xl:min-w-0;
          @apply overflow-x-auto xl:overflow-visible;
          
          /* 스크롤바 숨기기 */
          &::-webkit-scrollbar {
            display: none;
          }
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
        
        .mega-menu-item {
          @apply list-none relative flex-shrink-0;
          
          .mega-menu-link {
            @apply text-h-600 dark:text-h-300 hover:text-h-900 dark:hover:text-h-100 font-medium transition-colors no-underline text-sm px-3 py-2 block whitespace-nowrap;
          }
          
          .mega-menu-dropdown {
            @apply absolute top-full left-0 mt-1 bg-h-100 dark:bg-h-800 border border-h-300 dark:border-h-700 rounded-lg shadow-lg p-3 min-w-[200px] opacity-0 invisible transition-all duration-200 z-50;
          }
          
          &:hover .mega-menu-dropdown {
            @apply opacity-100 visible;
          }
          
          /* 사이드바에서 복제된 sub_category_list의 hidden 스타일 초기화 */
          .sub_category_list {
            @apply m-0 p-0;
            display: block !important;
            height: auto !important;
            overflow: visible !important;
            
            li {
              @apply list-none;
            }
            
            a {
              @apply block py-1.5 px-2 rounded text-xs text-h-600 dark:text-h-400 hover:bg-h-200 dark:hover:bg-h-700 hover:text-h-900 dark:hover:text-h-100 transition-colors no-underline;
            }
            
            .c_cnt {
              @apply text-h-400 text-xs ml-1;
            }
          }
        }
      }
    }





script.
  ;document.addEventListener('alpine:init', () => Alpine.data('top', () => ({
    /**
     * @property {boolean} open
     */
    open: true,

    /**
     * Init
     */
    init () {
      this.toggle()
    },

    /**
     * Toggle
     */
    toggle () {
      this.$targets.forEach(el => {
        if (document.body.contains(el)) {
          this.open = el.getBoundingClientRect().bottom < 0
        }
      })
    },

    /**
     * targets
     *
     * @returns {Array<HTMLElement>}
     */
    get $targets () {
      return [
        this.$refs.header,
        this.$refs.globalHeader
      ]
    }
  })))

script.
  ;document.addEventListener('alpine:init', () => Alpine.data('menuToolbar', () => ({
    /**
     * Init
     */
    init () {
      if (/^(.*\.tistory\.com)$/.test(location.hostname)) {
        this.setTistoryMenubar()
      }
    },

    /**
     * Set TISTORY menu toolbar
     */
    setTistoryMenubar () {
      const tistoryMenubar = document.getElementById('menubar_wrapper')

      if (tistoryMenubar) {
        tistoryMenubar.setAttribute('x-data', 'tistoryMenubar')
        tistoryMenubar.setAttribute('x-on:resize.window', 'toggle')

        this.$el.append(tistoryMenubar)
      }
    }
  })))

script.
  ;document.addEventListener('alpine:init', () => Alpine.data('subscribe', () => ({
    /**
     * Can subscribe?
     */
    canSubscribe () {
      return T.config.ROLE !== "owner" && /^(.*\.tistory\.com)$/.test(location.hostname)
    }
  })))

script.
  ;document.addEventListener('alpine:init', () => Alpine.data('tistoryMenubar', () => ({
    /**
     * Init
     */
    init () {
      this.toggle()
    },

    /**
     * Toggle TISTORY menu toolbar by hidden condition
     */
    toggle () {
      this.$el.style.display = this.hidden ? 'none' : 'inline-block'
    },

    /**
     * Is hidden?
     *
     * @var {boolean}
     */
    get hidden () {
      const containerLg = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--h-idx'), 10)

      return T.config.ROLE !== "owner" && window.innerWidth < containerLg // max-lg
    }
  })))

style
  :postcss
    .menu_toolbar {
      @apply hidden;
    }

style
  :postcss
    #top {
      .menu_toolbar {
        @apply static flex gap-x-2.5;

        .subscribe,
        .btn_menu_type2 {
          @apply flex justify-center items-center w-9 h-9 p-0 rounded-full outline-0 bg-h-200 text-h-500 shadow-none hover:bg-h-300;
          @apply dark:text-h-200 dark:bg-h-700 dark:hover:bg-h-600;
        }

        .subscribe {
          .ico {
            @apply font-awesome;
          }
        }
      }
    }

style
  :postcss
    #menubar_wrapper {
      @apply relative;

      .btn_menu_type2 {
        .ico_tistory_sign {
          @apply opacity-70 dark:opacity-100 dark:invert;
        }
      }

      .header_layer {
        @apply absolute top-12 right-0 left-auto bottom-auto;
        @apply shadow-none bg-h-200 dark:bg-h-700;

        &::after {
          @apply hidden;
        }

        a {
          @apply no-underline;
        }

        .info_profile {
          @apply border-b-h-300 dark:border-b-h-600;

          .txt_id {
            @apply text-h-500 dark:text-h-200;
          }

          .txt_email,
          .link_setting_type2 {
            @apply text-h-400 hover:text-h-800 dark:hover:text-h-200;
          }
        }

        .list_toolbar {
          li {
            .link_list {
              @apply text-h-500 dark:text-h-200;
            }

            &:last-child {
              .link_list {
                @apply text-h-400 hover:text-h-800 dark:hover:text-h-200;
              }
            }
          }
        }

        .wrap_list {
          .tit_list_type {
            @apply text-h-400 hover:text-h-800 dark:hover:text-h-200;
          }
        }

        .wrap_toolbar {
          @apply border-t-h-300 dark:border-t-h-600;
        }
      }
    }
